---
const currentPath = Astro.url.pathname;
// Cek apakah halaman manajemen data (guru/kelas) sedang aktif
const isDataPage = currentPath.includes('/admin/guru');

const isActive = (path) => {
    if (path === '/admin' && (currentPath === '/admin' || currentPath === '/admin/')) return true;
    if (path !== '/admin' && currentPath.includes(path)) return true;
    return false;
};
---

<div class="fixed bottom-6 left-0 right-0 px-4 lg:hidden z-50">
    <div class="bg-base-100/95 backdrop-blur-md text-gray-500 rounded-full shadow-[0_8px_30px_rgb(0,0,0,0.12)] h-16 border border-gray-200 flex items-center justify-between px-2 relative">
        
        <div class={`grid ${isDataPage ? 'grid-cols-5' : 'grid-cols-4'} w-full h-full items-center`}>

            <a href="/admin" class="col-span-1 h-full flex flex-col items-center justify-center gap-1 transition-all duration-300 group">
                <div class={`p-1.5 rounded-xl transition-all ${isActive('/admin') ? 'bg-primary/10 text-primary' : 'text-gray-400 group-hover:text-primary'}`}>
                    <i class="fa-solid fa-chart-pie text-xl"></i>
                </div>
                <span class={`text-[10px] font-medium transition-all ${isActive('/admin') ? 'text-primary opacity-100' : 'opacity-0 h-0 overflow-hidden'}`}>Home</span>
            </a>

            <a href="/admin/guru" class="col-span-1 h-full flex flex-col items-center justify-center gap-1 transition-all duration-300 group">
                <div class={`p-1.5 rounded-xl transition-all ${isActive('/admin/guru') ? 'bg-primary/10 text-primary' : 'text-gray-400 group-hover:text-primary'}`}>
                    <i class="fa-solid fa-users text-xl"></i>
                </div>
                <span class={`text-[10px] font-medium transition-all ${isActive('/admin/guru') ? 'text-primary opacity-100' : 'opacity-0 h-0 overflow-hidden'}`}>Data</span>
            </a>

            {/* TOMBOL TENGAH (+) HANYA DI HALAMAN DATA */}
            {isDataPage && (
                <div class="col-span-1 relative h-full group">
                    <div class="absolute -top-6 left-1/2 transform -translate-x-1/2">
                        <button onclick="mobile_action_sheet.showModal()" class="btn btn-circle btn-primary btn-lg border-[6px] border-base-200 shadow-xl text-white hover:scale-110 hover:-translate-y-1 transition-all duration-300">
                            <i class="fa-solid fa-plus text-2xl"></i>
                        </button>
                    </div>
                </div>
            )}

            <a href="/admin/dokumen" class="col-span-1 h-full flex flex-col items-center justify-center gap-1 transition-all duration-300 group">
                <div class={`p-1.5 rounded-xl transition-all ${isActive('/admin/dokumen') ? 'bg-primary/10 text-primary' : 'text-gray-400 group-hover:text-primary'}`}>
                    <i class="fa-solid fa-file-export text-xl"></i>
                </div>
                <span class={`text-[10px] font-medium transition-all ${isActive('/admin/dokumen') ? 'text-primary opacity-100' : 'opacity-0 h-0 overflow-hidden'}`}>Kirim</span>
            </a>

            <button onclick="handleSidebarLogout()" class="col-span-1 h-full flex flex-col items-center justify-center gap-1 transition-all duration-300 group">
                <div class="p-1.5 text-gray-400 group-hover:text-error group-hover:bg-red-50 rounded-xl transition-all">
                    <i class="fa-solid fa-sign-out-alt text-xl"></i>
                </div>
                <span class="text-[10px] font-medium opacity-0 h-0 overflow-hidden">Keluar</span>
            </button>
            
        </div>
    </div>
</div>

<dialog id="mobile_action_sheet" class="modal modal-bottom sm:modal-middle">
    <div class="modal-box p-4 rounded-t-3xl bg-base-100">
        <h3 class="font-bold text-lg text-center mb-4 text-gray-800">Tambah Data Baru</h3>
        
        <div class="flex flex-col gap-3">
            <button onclick="mobile_action_sheet.close(); openModalGuru()" class="btn btn-lg btn-outline border-gray-200 flex justify-start gap-4 items-center bg-white shadow-sm hover:border-primary hover:bg-primary/5">
                <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary">
                    <i class="fa-solid fa-chalkboard-user text-xl"></i>
                </div>
                <div class="text-left">
                    <div class="font-bold text-gray-800">Guru Baru</div>
                    <div class="text-xs text-gray-500 font-normal">Tambah akun pengajar</div>
                </div>
            </button>

            <button onclick="mobile_action_sheet.close(); openModalKelas()" class="btn btn-lg btn-outline border-gray-200 flex justify-start gap-4 items-center bg-white shadow-sm hover:border-secondary hover:bg-secondary/5">
                <div class="w-10 h-10 rounded-full bg-secondary/10 flex items-center justify-center text-secondary">
                    <i class="fa-solid fa-school text-xl"></i>
                </div>
                <div class="text-left">
                    <div class="font-bold text-gray-800">Kelas Baru</div>
                    <div class="text-xs text-gray-500 font-normal">Buat kelas & tahun ajaran</div>
                </div>
            </button>
        </div>

        <div class="modal-action justify-center mt-6">
            <form method="dialog">
                <button class="btn btn-circle btn-ghost text-gray-400 bg-gray-100 hover:bg-gray-200">
                    <i class="fa-solid fa-xmark text-lg"></i>
                </button>
            </form>
        </div>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>